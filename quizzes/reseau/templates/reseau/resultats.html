{% extends "base.html" %}

{% block extra_css %}
<link href="{{ url_for('reseau.static', filename='css/quiz.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<h3 class="mb-4">Résultats de la classe</h3>

{% if resultats %}
<div class="table-responsive">
    <table class="table table-striped table-bordered table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>Code</th>
                <th>Nom</th>
                <th>Prénom</th>
                <th>Date</th>
                <th class="text-center">1.1 Adr.<br><small class="fw-normal">/5</small></th>
                <th class="text-center">1.2 Comm.<br><small class="fw-normal">/5</small></th>
                <th class="text-center">Ex. 2<br><small class="fw-normal">/8</small></th>
                <th class="text-center">Total<br><small class="fw-normal">/18</small></th>
                <th class="text-center">%</th>
            </tr>
        </thead>
        <tbody>
            {% for r in resultats %}
            {% set st = r.score_total %}
            {% set pct = (st.correct / st.total * 100) | round | int if st.total > 0 else 0 %}
            <tr>
                <td class="font-monospace">{{ r.code }}</td>
                <td>{{ r.nom }}</td>
                <td>{{ r.prenom }}</td>
                <td>{{ r.date[:16] | replace("T", " ") }}</td>
                <td class="text-center">{{ r.exercice1.score_adresses.correct }}</td>
                <td class="text-center">{{ r.exercice1.score_communication.correct }}</td>
                <td class="text-center">{{ r.exercice2.score.correct }}</td>
                <td class="text-center fw-bold">{{ st.correct }}</td>
                <td class="text-center">
                    <span class="badge {% if pct >= 80 %}bg-success{% elif pct >= 50 %}bg-warning text-dark{% else %}bg-danger{% endif %}">
                        {{ pct }}%
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<p class="text-muted">{{ resultats | length }} soumission(s)</p>
{% else %}
<div class="alert alert-info">Aucune soumission pour l'instant.</div>
{% endif %}
{% endblock %}
